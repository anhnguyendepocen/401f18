\if \QLABELS1 Q2-1. \fi
To investigate the consequences of metal poisoning, 25 beakers of minnow larvae were exposed to varying levels of copper and zinc.
The data were

```{r lm_example}
toxicity <- read.table("toxicity.txt")
head(toxicity)
lm_toxicity <- lm(Protein~Copper+Zinc,data=toxicity)
round(coef(summary(lm_toxicity),3))
```
The sample linear model is $\vect{y}=\mat{X}\vect{b}+\vect{e}$.
Here, $y_i$ is a measurement of total larva protein at the end of the experiment (in microgram, $\mu g$). $\mat{X}=[x_{ij}]$ is a $25\times 3$ matrix where $x_{i1}=1$, $x_{i2}$ is copper concentration (in parts per million, ppm) in beaker $i$ , and $x_{i3}$ is zinc concentration (in parts per million, ppm) in beaker $i$.

Suppose we're interested in predicting the protein in a new observation at 100ppm copper and 1000ppm zinc.

(a) Specify the values in a row matrix $\vect{x}^*$ so that $\vect{y}^*=\vect{x}^*\vect{b}$ gives a least squares prediction of the new observation.


(b) Explain how to use the data vector $\vect{y}$, the design matrix $\mat{X}$, and your row vector $\vect{x}^*$ to construct a prediction interval that will cover the new measurement in approximately 95% of replications. Your answer should include formulas to construct this interval.

(c) Explain briefly some things you would look for to check whether your prediction interval is reasonable.

```{r,child="sol_q2-1.Rmd",eval=SOL}
```

-------


\if \QLABELS1 Q2-2. \fi
Consider the birth weight data set we have seen in lab.
For this question, we will look at columns `bwt` (birth weight), `lwt` (mother's weight), `age` (mother's age) and `race` (mother's race, 1 for white, 2 for black and 3 for other).
```{r}
library(MASS)
data(birthwt)
head(birthwt,3)
lm_bw <- lm(bwt ~ lwt + age +factor(race), data = birthwt)
summary(lm_bw)$coef
```
Now suppose we are interested in predicting the birthweight of a baby who has a 30-year-old white mother with weight 130. 

(a) Specify a row matrix $\vect{x}^*$ so that $\hat y^*=\vect{x}^*\vect{b}$ gives the least square predictor.

(b) Write a matrix expression for the variance of $\hat Y^*=\vect{x}^*\vect{\hat\beta}$ where $\vect{\hat\beta}$ is the least squares fit on model-generated data, i.e., $\vect{\hat\beta}=(\mat{X}^\transpose\mat{X})^{-1}\mat{X}^\transpose \vect{Y}$.

------------

\if \QLABELS1 Q2-3. \fi
We analyze the following data on video game sales in North America. This dataset records sales (in millions of dollars) for  580 games within three genres (shooter, sports and action) from two publishers (Electronic Arts and Activision) with years of release from 2006 to 2010 inclusive, on ten different platforms.
```{r}
vg <- read.table("vg_sales.txt") ; head(vg)
```
Consider the probability model $Y_{ijk} = \alpha + \beta_j + \gamma_k + \epsilon_{ijk}$ where $j=1,2,3$ specifies the genre (shooter, sports and action,  respectively), $k=1,2$ gives the publisher (Electronic Arts and Activision, respectively), and $i$ ranges over all the games in each $(j,k)$ category. In order to code these factors, we set $\beta_1=\gamma_1=0$.
As usual, $\epsilon_{ijk}$ gives an independent $N[0,\sigma]$ error for game $(i,j,k)$. Parameters in this probability model are estimated by least squares as follows:
```{r}
lm_vg1 <- lm(Sales ~ Publisher + Genre, data = vg)
summary(lm_vg1)
```
Note that the output of `summary(lm_vg1)` tells you that R is using $\vect{\beta}=(\alpha,\beta_2,\beta_3,\gamma_2)$ as the parameter vector.

(a) Write the first six lines of the design matrix $\mat{X}$ in the matrix version of the linear model $\vect{Y}=\mat{X}\vect{\beta}+\vect{\epsilon}$. Hint: the output from `head(vg)` tells you what the values of $j$ and $k$ are for each of the first six observations.


(b) Suppose we're interested in the predicting the North American Sales of a shooting game released by Activision. Specify a row matrix $\vect{x^*}$ such that $y^* = \vect{x^*b}$ gives the least square predictor of this quantity.

---------------

\if \QLABELS1 Q2-4. \fi
Recall the nels88 dataset from lab. These data are a subset of the National Education Longitudinal Study of 1988 which examined schoolchildrenâ€™s performance on a math test score in 8th grade. `ses` is the socioeconomic status of parents and `paredu` is the parents highest level of education achieved (less than high school, high school, college, BA, MA, PhD). The data were as follows:
```{r lm_nels88_example}
library(faraway)
data(nels88)
head(nels88)
```
We fit a regression model to the data. The rounded co-efficients for the model are provided below:
```{r}
fit <- lm(math ~ ses + paredu, data = nels88)
round(summary(fit)$coef)
```

(a)  Describe a suitable probability model, in matrix form, to give a sample version of the linear model that has been fit above.

```{r,child="sol_q2-4a.Rmd",eval=SOL}
```


(b) Find the predicted math score for a student whose family has an ses value of -0.5 and whose parents' highest education level is high school (`hs`).

```{r,child="sol_q2-4b.Rmd",eval=SOL}
```


(c) How is the residual standard error calculated for this model? (Give a formula).

```{r,child="sol_q2-4c.Rmd",eval=SOL}
```

-------


