\if \QLABELS1 Q3-1. \fi
Consider the following linear model for the mouse diet data that we have studied repeatedly
```{r}
mice <- read.table("femaleMiceWeights.csv",sep=",",header=TRUE)
head(mice)
lm_mice <- lm(Bodyweight~Diet,data=mice)
model.matrix(lm_mice)
```
(a) Write down the sample linear model fitted in `lm_mice` using the subscript format.

(b) Explain how to obtain estimates of the means of both treatment groups, and the difference between these means, from the coefficients of this sample linear model.

----------- 

\if \QLABELS1 Q3-2. \fi
Let's consider the crabs data set we studied in lab. Recall that species (`sp`) is a factor with two levels, Blue (`B`) and Orange (`O`). We want to study the difference of frontal lobe size (`FL`) of two species. 

```{r}
library(MASS)
data(crabs)
head(crabs)
```

Consider the probability model $Y_i = \mu_1x_{Bi} + \mu_2x_{Oi} + \epsilon_i$ for $i=1,...,200$. $Y_i$ is the frontal lobe size of crab $i$. $x_{Bi}$ is $1$ if crab $i$ is of species Blue and $0$ otherwise. Similarly, $x_{Oi}$ is $1$ if crab $i$ is of species Orange and $0$ otherwise. 
$\epsilon_i$ are i.i.d with mean $0$ and variance $\sigma^2$. This model can be fitted to the `crabs` dataset in R using the `lm()` function. The resulting summary is provided below.
```{r}
lm_crab <- lm(FL~sp-1, data=crabs)
summary(lm_crab)
```

(a) Interpret the meaning of $\mu_1$ and $\mu_2$ in the above probability model?

(b) Build a 95% confidence interval for $\mu_1$ using normal approximation

(c) Recall in homework we know that the full estimated covariance matrix of $\vect{\hat{\mu}} = (\hat{\mu}_1,\hat{\mu}_2)$ can be found by  
```{r}
V <- summary(lm_crab)$cov.unscaled * summary(lm_crab)$s^2
V
```
Use V and information provided in `summary(lm_crab)` to write down an expression that constructs a 95% confidence interval for $\mu_1-\mu_2$.

```{r,child="sol_q3-2.Rmd",eval=SOL}
```

------------------

\if \QLABELS1 Q3-3. \fi
We analyze the following data on video game sales in North America. This dataset records sales (in millions of dollars) for  580 games within three genres (shooter, sports and action) from two publishers (Electronic Arts and Activision) with years of release from 2006 to 2010 inclusive, on ten different platforms. We consider the following analysis
```{r}
vg <- read.table("vg_sales.txt") ; head(vg)
lm_vg2 <- lm(Sales ~ Publisher-1, data = vg)
summary(lm_vg2)
```
The fitted probability model is $Y_{ij} = \pi_j + \epsilon_{ij}$ where $j=1,2$ specifies the publisher (Electronic Arts and Activision, respectively),  and $i$ ranges over all the games for each publisher.
As usual, $\epsilon_{ij}$ gives an independent $N[0,\sigma]$ error for game $(i,j)$. Parameters in this probability model are estimated by least squares as follows:
 
(a) What do the coefficients in the summary above measure?

(b) Explain how to build a 95% confidence interval for Activision sales using a normal approximation.  You can use the property that $\prob[Z<1.96]=0.975$ when $Z$ has a $N[0,1]$ distribution.

-----------------------




\if \QLABELS1 Q3-4. \fi
Recall the crabs dataset used in lab. Here, `BD` refers to the body depth of the crabs, and `sp` denotes the colour of the crabs, which is one of blue or orange.

```{r}
library(MASS)
data(crabs)
head(crabs)
crabs$mu1 <- (crabs$sp == "B")*1
crabs$mu2 <- (crabs$sp == "O")*1
crabs$mu3 <- 1
crabs$mu4 <- 1-crabs$mu1
crabs$mu_diff <- crabs$mu2
fit1 <- lm(BD ~ mu1+mu2-1, data = crabs)
fit2 <- lm(BD ~ mu3 + mu_diff - 1, data = crabs)
fit3 <- lm(BD ~ mu2, data = crabs)
fit4 <- lm(BD ~ 1-mu1, data = crabs)
fit5 <- lm(BD ~ mu4, data = crabs)
fit6 <- lm(BD~  mu1+mu2, data = crabs)
```
(a) Would any of the models (`fit1` to `fit6`) give the same coefficients? If yes, list them.

```{r,child="sol_q3-4a.Rmd",eval=SOL}
```

Now consider the probability model $Y_i = \mu_1x_{Bi} + \mu_2x_{Oi} + \epsilon_i$, where $i=1,\dots,200$. $Y_i$ models the body weight of observation $i$. 
$x_{Bi}$ is 1 if `sp=B` for observation $i$ and 0 otherwise. 
Similarly, $x_{Oi}$ is 1 if `sp=O` for observation $i$ and 0 otherwise. 
$\epsilon_1,\dots,\epsilon_{200}$ are i.i.d with mean 0 and variance $\sigma^2$. 
This model can be fitted to the `crabs` dataset in R using the `lm()` function. The resulting summary is provided below.
```{r}
summary(fit1)
```

(b) Interpret $\mu_1$ and $\mu_2$ in the above model?

```{r,child="sol_q3-4b.Rmd",eval=SOL}
```


(c) Recall from homework that the estimated covariance matrix of $\boldsymbol{\hat{\beta}} = (\hat{\mu}_1,\hat{\mu}_2)$ can be found by  
```{r}
V <- summary(fit1)$cov.unscaled * summary(fit1)$s^2; V
```
Construct a 95% confidence interval for $\mu_1-\mu_2$ using normal approximation. Based on this, do we have sufficient evidence to conclude that $\mu_1=\mu_2$ at the 95% level?

```{r,child="sol_q3-4c.Rmd",eval=SOL}
```


----------- 

